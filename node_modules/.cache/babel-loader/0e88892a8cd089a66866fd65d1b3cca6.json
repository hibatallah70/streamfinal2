{"ast":null,"code":"const readDefaultState = () => {\n  try {\n    return JSON.parse(window.sessionStorage.getItem('custom_storage'));\n  } catch (err) {\n    return {};\n  }\n};\n\nconst defaultState = {\n  // loading effect\n  loading: false,\n  // media devices\n  streams: [],\n  localStream: null,\n  currentStream: null,\n  otherStreams: [],\n  devicesList: [],\n  // web sdk params\n  config: {\n    uid: 0,\n    host: true,\n    channelName: '',\n    token: process.env.REACT_APP_AGORA_APP_TOKEN,\n    resolution: '480p',\n    ...readDefaultState(),\n    microphoneId: '',\n    cameraId: ''\n  },\n  agoraClient: null,\n  mode: 'live',\n  codec: 'vp8',\n  muteVideo: false,\n  muteAudio: false,\n  screen: false,\n  profile: false\n};\n\nconst reducer = (state, action) => {\n  switch (action.type) {\n    case 'config':\n      {\n        return { ...state,\n          config: action.payload\n        };\n      }\n\n    case 'client':\n      {\n        return { ...state,\n          client: action.payload\n        };\n      }\n\n    case 'loading':\n      {\n        return { ...state,\n          loading: action.payload\n        };\n      }\n\n    case 'codec':\n      {\n        return { ...state,\n          codec: action.payload\n        };\n      }\n\n    case 'video':\n      {\n        return { ...state,\n          muteVideo: action.payload\n        };\n      }\n\n    case 'audio':\n      {\n        return { ...state,\n          muteAudio: action.payload\n        };\n      }\n\n    case 'screen':\n      {\n        return { ...state,\n          screen: action.payload\n        };\n      }\n\n    case 'devicesList':\n      {\n        return { ...state,\n          devicesList: action.payload\n        };\n      }\n\n    case 'localStream':\n      {\n        return { ...state,\n          localStream: action.payload\n        };\n      }\n\n    case 'profile':\n      {\n        return { ...state,\n          profile: action.payload\n        };\n      }\n\n    case 'currentStream':\n      {\n        const {\n          streams\n        } = state;\n        const newCurrentStream = action.payload;\n        const otherStreams = streams.filter(it => it.getId() !== newCurrentStream.getId());\n        return { ...state,\n          currentStream: newCurrentStream,\n          otherStreams\n        };\n      }\n\n    case 'addStream':\n      {\n        const {\n          streams,\n          currentStream\n        } = state;\n        const newStream = action.payload;\n        let newCurrentStream = currentStream;\n\n        if (!newCurrentStream) {\n          newCurrentStream = newStream;\n        }\n\n        if (streams.length === 4) return { ...state\n        };\n        const newStreams = [...streams, newStream];\n        const otherStreams = newStreams.filter(it => it.getId() !== newCurrentStream.getId());\n        return { ...state,\n          streams: newStreams,\n          currentStream: newCurrentStream,\n          otherStreams\n        };\n      }\n\n    case 'removeStream':\n      {\n        const {\n          streams,\n          currentStream\n        } = state;\n        const {\n          stream,\n          uid\n        } = action;\n        const targetId = stream ? stream.getId() : uid;\n        let newCurrentStream = currentStream;\n        const newStreams = streams.filter(stream => stream.getId() !== targetId);\n\n        if (currentStream && targetId === currentStream.getId()) {\n          if (newStreams.length === 0) {\n            newCurrentStream = null;\n          } else {\n            newCurrentStream = newStreams[0];\n          }\n        }\n\n        const otherStreams = newCurrentStream ? newStreams.filter(it => it.getId() !== newCurrentStream.getId()) : [];\n        return { ...state,\n          streams: newStreams,\n          currentStream: newCurrentStream,\n          otherStreams\n        };\n      }\n\n    case 'clearAllStream':\n      {\n        // const {streams, localStream, currentStream, beauty} = state;\n        const {\n          streams,\n          localStream,\n          currentStream\n        } = state;\n        streams.forEach(stream => {\n          if (stream.isPlaying()) {\n            stream.stop();\n          } // stream.close();\n\n        });\n\n        if (localStream) {\n          localStream.isPlaying() && localStream.stop();\n          localStream.close();\n        }\n\n        if (currentStream) {\n          currentStream.isPlaying() && currentStream.stop();\n          currentStream.close();\n        }\n\n        return { ...state,\n          currentStream: null,\n          localStream: null,\n          streams: []\n        };\n      }\n    // case 'enableBeauty': {\n    //   return {\n    //     ...state,\n    //     beauty: action.enable\n    //   }\n    // }\n\n    default:\n      throw new Error('mutation type not defined');\n  }\n};\n\nexport { reducer, defaultState };","map":{"version":3,"names":["readDefaultState","JSON","parse","window","sessionStorage","getItem","err","defaultState","loading","streams","localStream","currentStream","otherStreams","devicesList","config","uid","host","channelName","token","process","env","REACT_APP_AGORA_APP_TOKEN","resolution","microphoneId","cameraId","agoraClient","mode","codec","muteVideo","muteAudio","screen","profile","reducer","state","action","type","payload","client","newCurrentStream","filter","it","getId","newStream","length","newStreams","stream","targetId","forEach","isPlaying","stop","close","Error"],"sources":["C:/Users/hp/AppData/Local/Programs/Python/Python310/version video+blog+ lobby+chat1/src/utils/store.js"],"sourcesContent":["const readDefaultState = () => {\r\n    try {\r\n        return JSON.parse(window.sessionStorage.getItem('custom_storage'))\r\n    } catch (err) {\r\n        return {}\r\n    }\r\n}\r\n\r\nconst defaultState = {\r\n    // loading effect\r\n    loading: false,\r\n    // media devices\r\n    streams: [],\r\n    localStream: null,\r\n    currentStream: null,\r\n    otherStreams: [],\r\n    devicesList: [],\r\n    // web sdk params\r\n    config: {\r\n        uid: 0,\r\n        host: true,\r\n        channelName: '',\r\n        token: process.env.REACT_APP_AGORA_APP_TOKEN,\r\n        resolution: '480p',\r\n        ...readDefaultState(),\r\n        microphoneId: '',\r\n        cameraId: ''\r\n    },\r\n    agoraClient: null,\r\n    mode: 'live',\r\n    codec: 'vp8',\r\n    muteVideo: false,\r\n    muteAudio: false,\r\n    screen: false,\r\n    profile: false\r\n}\r\n\r\nconst reducer = (state, action) => {\r\n    switch (action.type) {\r\n        case 'config': {\r\n            return {...state, config: action.payload}\r\n        }\r\n        case 'client': {\r\n            return {...state, client: action.payload}\r\n        }\r\n        case 'loading': {\r\n            return {...state, loading: action.payload}\r\n        }\r\n        case 'codec': {\r\n            return {...state, codec: action.payload}\r\n        }\r\n        case 'video': {\r\n            return {...state, muteVideo: action.payload}\r\n        }\r\n        case 'audio': {\r\n            return {...state, muteAudio: action.payload}\r\n        }\r\n        case 'screen': {\r\n            return {...state, screen: action.payload}\r\n        }\r\n        case 'devicesList': {\r\n            return {...state, devicesList: action.payload}\r\n        }\r\n        case 'localStream': {\r\n            return {...state, localStream: action.payload}\r\n        }\r\n        case 'profile': {\r\n            return {...state, profile: action.payload}\r\n        }\r\n        case 'currentStream': {\r\n            const {streams} = state\r\n            const newCurrentStream = action.payload\r\n            const otherStreams = streams.filter(\r\n                (it) => it.getId() !== newCurrentStream.getId()\r\n            )\r\n            return {...state, currentStream: newCurrentStream, otherStreams}\r\n        }\r\n        case 'addStream': {\r\n            const {streams, currentStream} = state\r\n            const newStream = action.payload\r\n            let newCurrentStream = currentStream\r\n            if (!newCurrentStream) {\r\n                newCurrentStream = newStream\r\n            }\r\n            if (streams.length === 4) return {...state}\r\n            const newStreams = [...streams, newStream]\r\n            const otherStreams = newStreams.filter(\r\n                (it) => it.getId() !== newCurrentStream.getId()\r\n            )\r\n            return {\r\n                ...state,\r\n                streams: newStreams,\r\n                currentStream: newCurrentStream,\r\n                otherStreams\r\n            }\r\n        }\r\n        case 'removeStream': {\r\n            const {streams, currentStream} = state\r\n            const {stream, uid} = action\r\n            const targetId = stream ? stream.getId() : uid\r\n            let newCurrentStream = currentStream\r\n            const newStreams = streams.filter(\r\n                (stream) => stream.getId() !== targetId\r\n            )\r\n            if (currentStream && (targetId === currentStream.getId())) {\r\n                if (newStreams.length === 0) {\r\n                    newCurrentStream = null\r\n                } else {\r\n                    newCurrentStream = newStreams[0]\r\n                }\r\n            }\r\n            const otherStreams = newCurrentStream\r\n                ? newStreams.filter((it) => it.getId() !== newCurrentStream.getId())\r\n                : []\r\n            return {\r\n                ...state,\r\n                streams: newStreams,\r\n                currentStream: newCurrentStream,\r\n                otherStreams\r\n            }\r\n        }\r\n        case 'clearAllStream': {\r\n            // const {streams, localStream, currentStream, beauty} = state;\r\n            const {streams, localStream, currentStream} = state\r\n            streams.forEach((stream) => {\r\n                if (stream.isPlaying()) {\r\n                    stream.stop()\r\n                }\r\n                // stream.close();\r\n            })\r\n\r\n            if (localStream) {\r\n                localStream.isPlaying() && localStream.stop()\r\n                localStream.close()\r\n            }\r\n            if (currentStream) {\r\n                currentStream.isPlaying() && currentStream.stop()\r\n                currentStream.close()\r\n            }\r\n            return {...state, currentStream: null, localStream: null, streams: []}\r\n        }\r\n        // case 'enableBeauty': {\r\n        //   return {\r\n        //     ...state,\r\n        //     beauty: action.enable\r\n        //   }\r\n        // }\r\n        default:\r\n            throw new Error('mutation type not defined')\r\n    }\r\n}\r\n\r\nexport {reducer, defaultState}\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}